<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F2-Unit 3 : Understanding Paragraphs</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&family=Sarabun:wght@400;600&display=swap');
        
        :root {
            --primary: #283593;
            --accent: #ff6f00;
            --bg: #e8eaf6;
            --text: #333;
        }

        * { box-sizing: border-box; }

        body { font-family: 'Prompt', sans-serif; background-color: var(--bg); margin: 0; padding: 20px; color: var(--text); min-height: 100vh; display: flex; justify-content: center; align-items: center; }
        
        .container { width: 100%; max-width: 650px; background: white; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); overflow: hidden; display: flex; flex-direction: column; min-height: 650px; position: relative; }
        
        /* Header */
        .top-bar { padding: 15px 20px; background: var(--primary); color: white; display: flex; justify-content: space-between; align-items: center; }
        .subject-name { font-size: 0.8em; opacity: 0.9; font-weight: 300; }
        .user-display { font-size: 0.9em; font-weight: bold; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 20px; }

        /* Screens */
        .screen { padding: 30px 20px; flex: 1; display: none; flex-direction: column; align-items: center; animation: fadeIn 0.4s ease-in-out; width: 100%; }
        .screen.active { display: flex; }

        /* Typography */
        h2 { color: var(--primary); text-align: center; margin-bottom: 20px; font-size: 1.6em; }
        p { line-height: 1.6; margin-bottom: 15px; width: 100%; }
        
        .content-box { width: 100%; background: #f5f5f5; padding: 25px; border-radius: 12px; margin-bottom: 20px; font-family: 'Sarabun', sans-serif; font-size: 1.1em; text-align: left; border-left: 6px solid var(--accent); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .highlight { background: #fff8e1; padding: 2px 6px; border-radius: 4px; font-weight: bold; color: #d84315; }
        .instruction { font-size: 0.95em; color: #555; text-align: center; margin-bottom: 15px; font-style: italic; background: #e3f2fd; padding: 10px; border-radius: 8px; width: 100%; }

        /* Inputs & Buttons */
        /* ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ type="number" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
        input[type="number"] { padding: 15px; font-size: 1.3em; width: 80%; text-align: center; border: 2px solid #ddd; border-radius: 50px; margin: 20px 0; outline: none; font-family: 'Prompt', sans-serif; transition: 0.3s; }
        input:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(40, 53, 147, 0.2); }

        .btn { padding: 12px 30px; border: none; border-radius: 50px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-family: 'Prompt', sans-serif; }
        .btn-primary { background: linear-gradient(135deg, var(--primary), #1a237e); color: white; width: 100%; max-width: 300px; }
        .btn-primary:active { transform: scale(0.95); }
        .btn-secondary { background: #e0e0e0; color: #555; }
        .btn-nav-group { width: 100%; display: flex; justify-content: space-between; margin-top: auto; padding-top: 20px; }

        /* Interactive Sentence */
        .sentence-item { padding: 12px; margin-bottom: 10px; border-radius: 8px; cursor: pointer; transition: 0.2s; border: 2px solid transparent; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .sentence-item:hover { border-color: var(--primary); transform: translateX(5px); }
        .sentence-item.sel-mi { background: #c8e6c9; border-color: #2e7d32; font-weight: bold; color: #1b5e20; }
        .sentence-item.sel-mi::before { content: 'üëë MAIN IDEA: '; }
        .sentence-item.sel-sd { background: #bbdefb; border-color: #1565c0; color: #0d47a1; }
        .sentence-item.sel-sd::before { content: 'üîπ DETAIL: '; }

        /* Game Sorting */
        .sort-area { width: 100%; display: flex; flex-direction: column; gap: 12px; }
        .sort-card { background: white; border: 2px solid #ddd; padding: 15px; border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: 500; transition: 0.2s; }
        .sort-card:hover { border-color: var(--accent); }
        .sort-card.picked { background: #cfd8dc; color: #78909c; cursor: default; border-color: #ccc; text-decoration: line-through; opacity: 0.6; }
        .ans-slot { min-height: 60px; background: #fff3e0; border: 2px dashed var(--accent); border-radius: 10px; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; color: var(--accent); font-weight: bold; padding: 15px; font-size: 1.1em; }

        /* Quiz Choices */
        .quiz-container { width: 100%; }
        .quiz-progress { text-align: right; font-size: 0.9em; color: #888; margin-bottom: 10px; }
        .quiz-option { width: 100%; padding: 18px; text-align: left; background: white; border: 2px solid #eee; border-radius: 15px; margin-bottom: 12px; cursor: pointer; transition: 0.2s; font-family: 'Sarabun', sans-serif; font-size: 1.1em; }
        .quiz-option:hover { border-color: var(--primary); background: #e8eaf6; transform: translateY(-2px); }
        .quiz-option.locked { pointer-events: none; opacity: 0.8; }
        .quiz-option.correct { background: #a5d6a7; border-color: #388e3c; color: #1b5e20; }
        .quiz-option.wrong { background: #ef9a9a; border-color: #d32f2f; color: #b71c1c; }

        /* Certificate */
        .cert-card { border: 10px double var(--primary); padding: 30px; margin-top: 10px; position: relative; background: #fff; width: 100%; text-align: center; overflow: hidden; }
        .cert-title { font-size: 2em; color: var(--primary); font-weight: bold; margin: 15px 0; }
        .cert-name { font-size: 1.8em; color: var(--accent); font-weight: bold; margin: 20px 0; border-bottom: 2px solid #eee; display: inline-block; padding-bottom: 10px; min-width: 200px; }
        .cert-score { font-size: 3em; font-weight: bold; color: #333; }
        .stamp { color: #c62828; border: 3px solid #c62828; display: inline-block; padding: 5px 20px; font-weight: bold; transform: rotate(-15deg); font-size: 1.5em; margin-top: 20px; opacity: 0.7; }
        
        /* Watermark */
        .watermark-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; opacity: 0.05; display: flex; flex-wrap: wrap; justify-content: center; align-content: center; transform: rotate(-20deg) scale(1.2); }
        .wm-item { margin: 30px; font-weight: bold; font-size: 16px; white-space: nowrap; color: #000; }
        .cert-content { position: relative; z-index: 2; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div class="top-bar">
        <div>
            <div style="font-weight:bold; font-size:1.2em;">Paragraph Master üèÜ</div>
            <div class="subject-name">‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≠ 2 (‡∏≠30212)</div>
        </div>
        <div id="userDisplay" class="user-display">Guest</div>
    </div>

    <div id="screen-login" class="screen active">
        <div style="text-align: center; margin: auto; width: 100%;">
            <div style="font-size: 5em; margin-bottom: 10px;">üè´</div>
            <h2>English for Future Studies 2</h2>
            <p>Unit 3: Understanding Paragraphs</p>
            <p style="font-size:0.9em; color:#d84315;">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤: ‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</p>
            
            <input type="number" id="inputID" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 5 ‡∏´‡∏•‡∏±‡∏Å" onkeypress="if(event.key === 'Enter') checkLogin()">
            <br>
            <button class="btn btn-primary" onclick="checkLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
            <p style="font-size: 0.8em; color: #999; margin-top: 30px;">(‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏°.6/3, 6/4)</p>
            
            <div style="margin-top: 30px; cursor: pointer; color: #e0e0e0; font-size: 0.8em;" onclick="adminReset()">
                [ üîÑ Admin Reset ]
            </div>
        </div>
    </div>

    <div id="screen-lesson" class="screen">
        <div id="lesson-content" style="width: 100%;"></div>
    </div>

    <div id="screen-result" class="screen"></div>
</div>

<script>
    // --- DATABASE ---
    const students = {
        "012345": { name: "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏®‡∏£‡∏∏‡∏ï‡∏≤ ‡∏à‡∏±‡∏ô‡∏ó‡πÄ‡∏Å‡∏ï‡∏∏", class: "Teacher", no: 99 },
        "11456": { name: "‡∏ô‡∏≤‡∏¢‡∏ß‡∏∏‡∏í‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏≤‡∏™‡∏≤", class: "‡∏°.6/3", no: 1 }, "11478": { name: "‡∏ô‡∏≤‡∏¢‡πÄ‡∏à‡∏©‡∏é‡∏≤ ‡∏ô‡∏∏‡∏Ç‡∏∏‡∏ô‡∏ó‡∏î", class: "‡∏°.6/3", no: 2 }, "11490": { name: "‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏£‡∏ß‡∏¥‡∏ä‡∏ç‡πå ‡∏Ñ‡∏ì‡∏≤‡∏ç‡∏≤‡∏ï‡∏¥", class: "‡∏°.6/3", no: 3 }, "11513": { name: "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏≠‡∏Å", class: "‡∏°.6/3", no: 4 }, "11516": { name: "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡πÄ‡∏ß‡∏ä ‡∏õ‡∏£‡∏∞‡∏´‡∏π‡∏®‡∏£‡∏µ", class: "‡∏°.6/3", no: 5 }, "11519": { name: "‡∏ô‡∏≤‡∏¢‡∏£‡∏±‡∏ê‡∏û‡∏á‡∏®‡πå ‡∏û‡∏£‡∏°‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå", class: "‡∏°.6/3", no: 6 }, "11520": { name: "‡∏ô‡∏≤‡∏¢‡∏ß‡∏≤‡∏£‡∏™‡∏≤‡∏£ ‡∏™‡∏≤‡∏¢‡∏®‡∏£", class: "‡∏°.6/3", no: 7 }, "11574": { name: "‡∏ô‡∏≤‡∏¢‡∏Å‡∏ô‡∏Å‡∏ô‡∏±‡∏ô‡∏ò‡πå ‡∏≠‡∏≥‡∏Ñ‡∏≤‡∏´‡∏•‡πâ‡∏≤", class: "‡∏°.6/3", no: 8 }, "11575": { name: "‡∏ô‡∏≤‡∏¢‡∏Å‡∏§‡∏©‡∏é‡∏≤ ‡πÅ‡∏Å‡∏°‡∏à‡∏¥‡∏ô‡∏î‡∏≤", class: "‡∏°.6/3", no: 9 }, "11578": { name: "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡∏õ‡∏∏‡∏£‡∏≤‡∏ñ‡∏≤‡πÄ‡∏ô", class: "‡∏°.6/3", no: 10 }, "11588": { name: "‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏™‡∏¥‡∏ï ‡∏û‡∏á‡∏®‡∏Å‡∏∏‡∏•", class: "‡∏°.6/3", no: 11 }, "11918": { name: "‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ä‡∏≤‡∏û‡∏• ‡∏Ñ‡∏£‡∏≠‡∏á‡∏¢‡∏∏‡∏ï‡∏¥", class: "‡∏°.6/3", no: 12 }, "12471": { name: "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏°‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏´‡∏•‡∏≤‡∏ö‡∏´‡∏ô‡∏≠‡∏á‡πÅ‡∏™‡∏á", class: "‡∏°.6/3", no: 13 }, "12472": { name: "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏î‡πà‡∏≤‡∏ô‡∏°‡∏ì‡∏µ", class: "‡∏°.6/3", no: 14 }, "12775": { name: "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡πÄ‡∏à‡∏ï‡∏ô‡πå ‡∏û‡∏∏‡∏ó‡∏ò‡∏™‡∏±‡∏á‡∏Ç‡πå", class: "‡∏°.6/3", no: 16 }, "11493": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏ì‡∏µ ‡∏â‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏ô‡∏ó‡∏ß‡∏µ‡∏™‡∏∏‡∏Ç", class: "‡∏°.6/3", no: 17 }, "11499": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏û‡∏£ ‡∏î‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå", class: "‡∏°.6/3", no: 18 }, "11501": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏û‡πá‡∏ç‡∏û‡∏¥‡∏ä‡∏ä‡∏≤ ‡∏™‡∏µ‡∏ó‡∏≠‡∏á", class: "‡∏°.6/3", no: 19 }, "11533": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏¢‡∏∏‡∏û‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏™‡∏µ‡πÅ‡∏î‡∏á", class: "‡∏°.6/3", no: 20 }, "11596": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ó‡∏¥‡∏û‡∏ß‡∏£‡∏£‡∏ì ‡∏ö‡∏∏‡∏ç‡∏Ñ‡∏∏‡πà‡∏¢", class: "‡∏°.6/3", no: 21 }, "11628": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏°‡∏•‡πÄ‡∏ô‡∏ï‡∏£ ‡∏§‡∏ó‡∏ò‡∏¥‡πÄ‡∏î‡∏ä", class: "‡∏°.6/3", no: 22 }, "11632": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ó‡∏¥‡∏û‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏£‡πà‡∏°‡∏£‡∏∑‡πà‡∏ô", class: "‡∏°.6/3", no: 23 }, "12473": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏ô‡∏≤‡∏†‡∏≤ ‡∏ô‡∏≤‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥", class: "‡∏°.6/3", no: 24 }, "12474": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏ê‡∏ß‡∏¥‡∏†‡∏≤ ‡∏à‡∏±‡∏ô‡∏™‡∏≥‡∏£‡∏ß‡∏°", class: "‡∏°.6/3", no: 25 }, "12476": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏£‡∏±‡∏ç‡∏ç‡∏≤‡∏°‡∏∞‡∏•‡∏¥‡∏ã‡πâ‡∏≠‡∏ô", class: "‡∏°.6/3", no: 26 },
        "11484": { name: "‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏ï‡∏¥ ‡∏õ‡∏£‡∏∞‡∏´‡∏π‡∏®‡∏£‡∏µ", class: "‡∏°.6/4", no: 1 }, "11518": { name: "‡∏ô‡∏≤‡∏¢‡∏†‡∏π‡∏°‡∏¥‡∏û‡∏±‡∏í‡∏ì‡πå ‡∏™‡∏µ‡∏ô‡∏ß‡∏•", class: "‡∏°.6/4", no: 2 }, "11523": { name: "‡∏ô‡∏≤‡∏¢‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå‡∏ä‡∏±‡∏¢ ‡∏û‡∏±‡∏ô‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç", class: "‡∏°.6/4", no: 3 }, "11582": { name: "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏Ñ‡∏° ‡∏ï‡∏£‡∏≤‡∏ú‡∏±‡∏Å‡πÅ‡∏ß‡πà‡∏ô", class: "‡∏°.6/4", no: 4 }, "11618": { name: "‡∏ô‡∏≤‡∏¢‡∏û‡∏µ‡∏£‡∏û‡∏±‡∏í‡∏ô‡πå ‡πÑ‡∏Å‡πà‡πÅ‡∏Å‡πâ‡∏ß", class: "‡∏°.6/4", no: 5 }, "11624": { name: "‡∏ô‡∏≤‡∏¢‡∏≠‡∏ò‡∏¥‡∏ä‡∏≤ ‡∏û‡∏•‡∏à‡∏≠‡∏´‡∏≠", class: "‡∏°.6/4", no: 6 }, "11674": { name: "‡∏ô‡∏≤‡∏¢‡∏£‡∏±‡∏ï‡∏†‡∏π‡∏°‡∏¥ ‡πÅ‡∏Å‡πà‡∏á‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å", class: "‡∏°.6/4", no: 7 }, "11957": { name: "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏û‡∏¥‡∏ê‡∏û‡∏ô‡∏ó‡πå ‡∏î‡∏≤‡∏®‡∏£‡∏µ", class: "‡∏°.6/4", no: 8 }, "12228": { name: "‡∏ô‡∏≤‡∏¢‡∏†‡∏π‡∏£‡∏¥‡∏û‡∏±‡∏ó‡∏ò‡πå ‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏à‡∏£‡∏¥‡∏ç", class: "‡∏°.6/4", no: 9 }, "12479": { name: "‡∏ô‡∏≤‡∏¢‡∏ó‡∏¥‡∏ê‡∏¥‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏à‡∏≤‡∏î‡∏ô‡∏≠‡∏Å", class: "‡∏°.6/4", no: 10 }, "12480": { name: "‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ô‡∏ô‡∏ó‡πå ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÄ‡∏î‡∏ä", class: "‡∏°.6/4", no: 11 }, "11465": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏†‡∏±‡∏ó‡∏£‡∏†‡∏£‡∏ì‡πå ‡∏ô‡∏≤‡∏Ñ‡∏ß‡∏±‡∏ô", class: "‡∏°.6/4", no: 12 }, "11505": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏¥‡∏¢‡∏∞‡∏é‡∏≤ ‡∏≠‡∏∏‡∏ï‡∏£‡∏µ", class: "‡∏°.6/4", no: 13 }, "11538": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏µ‡∏£‡∏∞‡∏ï‡∏≤ ‡∏™‡∏∑‡∏ö‡∏™‡∏∏‡∏ô‡∏ó‡∏£", class: "‡∏°.6/4", no: 14 }, "11567": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏•‡∏¥‡∏•‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏î‡∏á", class: "‡∏°.6/4", no: 15 }, "11568": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ä‡∏≤‡∏î‡∏≤ ‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå‡∏ô‡∏¥‡∏•", class: "‡∏°.6/4", no: 16 }, "11569": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏û‡∏¥‡∏ä‡∏å‡∏≤‡∏¢‡πå ‡∏Å‡∏≥‡πÄ‡∏´‡∏ô‡∏¥‡∏î", class: "‡∏°.6/4", no: 17 }, "11593": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏°‡∏•‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏û‡∏∑‡∏ä‡∏ô‡∏∞‡∏ú‡∏•", class: "‡∏°.6/4", no: 18 }, "11604": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏£‡∏ß‡∏¥‡∏ô‡∏ó‡πå ‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏á‡∏Ç‡πå", class: "‡∏°.6/4", no: 19 }, "11671": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏¥‡∏°‡∏ß‡∏≤ ‡πÅ‡∏™‡∏ô‡∏Ç‡∏ß‡∏≤", class: "‡∏°.6/4", no: 20 }, "11949": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏†‡∏±‡∏ó‡∏£‡∏ì‡∏ô‡∏¥‡∏î‡∏≤ ‡∏Å‡∏∏‡∏•‡∏ä‡∏±‡∏¢", class: "‡∏°.6/4", no: 21 }, "12481": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏∏‡πâ‡∏á‡∏•‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå ‡∏™‡∏≤‡∏¢‡∏™‡∏±‡∏á‡∏Ç‡πå", class: "‡∏°.6/4", no: 22 }, "12488": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ò‡∏±‡∏ç‡∏£‡∏±‡∏ï‡∏ô‡πå ‡πÅ‡∏ï‡∏á‡∏£‡∏≠‡∏î", class: "‡∏°.6/4", no: 23 }, "12778": { name: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏†‡∏¥‡∏ç‡∏ç‡∏≤ ‡∏á‡∏≤‡∏°‡∏™‡∏°", class: "‡∏°.6/4", no: 24 }
    };

    let currentUser = null;
    let slideIndex = 0;
    let quizScore = 0;
    let currentQuizSet = []; 

    // --- QUESTION BANK (20 ITEMS) ---
    const questionPool = [
        { q: "Main Idea ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö", "‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏™‡∏°‡∏≠"], ans: "‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á" },
        { q: "Topic Sentence ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Ç‡∏≠‡∏á‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤?", choices: ["‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏£‡∏Å", "‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á", "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢"], ans: "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏£‡∏Å" },
        { q: "Supporting Details (SDs) ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏° Main Idea", "‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á"], ans: "‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏° Main Idea" },
        { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î *‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà* ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á Supporting Details?", choices: ["Examples (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)", "Reasons (‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)", "Main Idea (‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å)"], ans: "Main Idea (‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å)" },
        { q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ 'For example' ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î?", choices: ["Main Idea", "Supporting Detail", "Conclusion"], ans: "Supporting Detail" },
        { q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ 'First, Second, Finally' ‡∏°‡∏±‡∏Å‡πÉ‡∏ä‡πâ‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•", "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç"], ans: "‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•" },
        { q: "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ Irrelevant Sentence ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î", "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏£‡∏∏‡∏õ"], ans: "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á" },
        { q: "‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ: 'Dogs are loyal friends.' ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô?", choices: ["Main Idea", "Specific Detail", "Statistic"], ans: "Main Idea" },
        { q: "‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ: 'They wait for you at the door.' ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô?", choices: ["Main Idea", "Supporting Detail", "Title"], ans: "Supporting Detail" },
        { q: "‡∏ñ‡πâ‡∏≤‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏π‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏Ç‡∏≠‡∏á‡∏ú‡∏±‡∏Å' ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÑ‡∏´‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ß‡∏Å?", choices: ["‡∏ú‡∏±‡∏Å‡∏°‡∏µ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞", "‡∏Å‡∏¥‡∏ô‡∏ú‡∏±‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢", "‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å"], ans: "‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å" },
        { q: "Topic Sentence ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ñ‡∏ß‡∏£‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£", "‡∏ö‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡∏∂‡∏Å‡πÜ", "‡∏ö‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥"], ans: "‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£" },
        { q: "‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏î‡∏ó‡∏µ‡πà SDs ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏ï‡∏≠‡∏ö?", choices: ["What time is it?", "Why? / How?", "What is your name?"], ans: "Why? / How?" },
        { q: "‡πÉ‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ Main Idea ‡∏Å‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å?", choices: ["1 ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô", "3 ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô", "‡∏Å‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ"], ans: "1 ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô" },
        { q: "Facts ‡πÅ‡∏•‡∏∞ Statistics ‡∏à‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡πÉ‡∏î?", choices: ["Topic", "Main Idea", "Supporting Details"], ans: "Supporting Details" },
        { q: "'Exercising makes you strong.' ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠?", choices: ["Reason (‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)", "Example (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)", "Topic"], ans: "Reason (‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)" },
        { q: "‡∏ñ‡πâ‡∏≤ Topic ‡∏Ñ‡∏∑‡∏≠ 'My Favorite Fruit' ‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠ MI ‡∏ó‡∏µ‡πà‡∏î‡∏µ?", choices: ["I like mangoes because they are sweet.", "Fruits are expensive.", "There are many fruits."], ans: "I like mangoes because they are sweet." },
        { q: "‡∏Å‡∏≤‡∏£‡∏´‡∏≤ Main Idea ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", choices: ["‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á", "‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á", "‡∏û‡∏£‡∏°‡πÄ‡∏ä‡πá‡∏î‡πÄ‡∏ó‡πâ‡∏≤"], ans: "‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á" },
        { q: "‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡∏î Supporting Details ‡∏≠‡∏≠‡∏Å ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô?", choices: ["‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô", "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏∂‡πâ‡∏ô", "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏≠‡∏∞‡πÑ‡∏£"], ans: "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô" },
        { q: "‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÉ‡∏î *‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà* Main Idea?", choices: ["Cats are cute pets.", "Smoking is bad for health.", "For instance, it causes cancer."], ans: "For instance, it causes cancer." },
        { q: "‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏†‡∏≤‡∏û (Unity) ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á?", choices: ["‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏û‡∏π‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô", "‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å‡πÜ", "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏¢‡∏≤‡∏ß‡πÜ"], ans: "‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏û‡∏π‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô" }
    ];

    // --- BASE SLIDES ---
    const baseSlides = [
        // 0-3: Intro & Theory
        { type: "intro", title: "Unit 3: Understanding Paragraphs", html: `<p><b>‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ:</b></p><ul><li>‡∏£‡∏∞‡∏ö‡∏∏ <b>Topic Sentence</b></li><li>‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞ <b>Main Idea</b> ‡πÅ‡∏•‡∏∞ <b>Supporting Details</b></li></ul><p>‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≠‡∏á‡πÅ‡∏ó‡πâ (Challenge Mode)</p>` },
        { type: "read", title: "1. Main Idea (‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)", html: `<p class="highlight">Main Idea ‡∏Ñ‡∏∑‡∏≠ "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏´‡∏•‡∏±‡∏Å" ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠</p><p>üîé <b>Tip:</b> ‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏£‡∏Å (Topic Sentence) ‡∏ó‡∏µ‡πà‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£</p>` },
        { type: "read", title: "2. Supporting Details (SDs)", html: `<p class="highlight">Supporting Details ‡∏Ñ‡∏∑‡∏≠ "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô"</p><p>‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° <i>Why? How?</i></p><p><b>‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà:</b> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Examples), ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (Reasons), ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (Facts)</p>` },
        { type: "read", title: "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", html: `<div style="background:white; border:1px solid #ddd; padding:15px; border-radius:8px; margin-bottom:15px;"><span style="color:#00695c; font-weight:bold;">[MI] Studying in a group has benefits.</span> <span style="color:#d81b60;">[SD] First, students can help each other.</span> <span style="color:#d81b60;">[SD] Second, it is more fun.</span></div>` },

        // 4-6: Exercises
        { type: "exercise", id: 1, title: "Exercise 1: Basic", desc: "‡∏à‡∏¥‡πâ‡∏°‡∏£‡∏∞‡∏ö‡∏∏: <b>Main Idea (1)</b> ‡πÅ‡∏•‡∏∞ <b>SDs (2)</b>", 
          sentences: ["There are many reasons to exercise.", "First, it makes muscles strong.", "Second, it reduces stress.", "Research shows it helps you sleep.", "Finally, it is fun."], ansMI: 0, ansSD: [1, 2, 3, 4] },
        { type: "exercise", id: 2, title: "Exercise 2: Intermediate", desc: "‡∏à‡∏¥‡πâ‡∏°‡∏£‡∏∞‡∏ö‡∏∏: <b>Main Idea (1)</b> ‡πÅ‡∏•‡∏∞ <b>SDs (2)</b>", 
          sentences: ["Smartphone addiction is a problem.", "Eyesight can get worse from staring at screens.", "Another issue is lack of sleep.", "Many people use phones in bed.", "It also hurts relationships."], ansMI: 0, ansSD: [1, 2, 3, 4] },
        { type: "exercise", id: 3, title: "Exercise 3: Advanced (New!)", desc: "‚ö†Ô∏è <b>‡∏Ç‡πâ‡∏≠‡∏¢‡∏≤‡∏Å:</b> ‡∏à‡∏¥‡πâ‡∏°‡∏£‡∏∞‡∏ö‡∏∏ <b>Main Idea (1)</b> ‡πÅ‡∏•‡∏∞ <b>SDs (3)</b>", 
          sentences: ["Social media has both pros and cons.", "On the positive side, it connects friends.", "It also provides useful news.", "However, it can waste our time.", "Cyberbullying is another negative effect.", "Users must use it wisely."], 
          ansMI: 0, ansSD: [1, 2, 3, 4] 
        },

        // 7-8: Game
        { type: "read", title: "Game: Paragraph Builder", html: `<p><b>‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à:</b> ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p><p style="color:red; font-weight:bold;">‚ö†Ô∏è ‡∏ï‡∏±‡∏î‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (Irrelevant) ‡∏ó‡∏¥‡πâ‡∏á 1 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ!</p>` },
        { type: "game", title: "Builder Challenge", items: [
            {id: 'A', txt: "(A) It gives energy for the day."},
            {id: 'B', txt: "(B) Breakfast is important."},
            {id: 'C', txt: "(C) Students concentrate better."},
            {id: 'D', txt: "(D) Coffee is popular."}
        ], answer: ['B', 'A', 'C'] },

        // 9: Quiz Intro
        { type: "quiz-intro", title: "Final Challenge Quiz", html: `<div style="text-align:center; font-size:3em;">üòà</div><p><b>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏î‡∏ú‡∏• (10 ‡∏Ç‡πâ‡∏≠)</b></p><p></p><p class="highlight" style="color:#c62828; background:#ffebee;"><b>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô: ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° 10/10 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!</b></p><p style="font-size:0.9em; color:#666;"></p>` }
    ];

    let currentSessionSlides = []; 

    // --- UTILS ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function generateQuizSet() {
        const shuffledPool = shuffleArray([...questionPool]);
        const selectedQuestions = shuffledPool.slice(0, 10);
        const quizSlides = selectedQuestions.map(qObj => {
            let opts = [...qObj.choices];
            opts = shuffleArray(opts);
            const correctIdx = opts.indexOf(qObj.ans);
            return {
                type: "quiz",
                q: qObj.q,
                options: opts,
                ans: correctIdx
            };
        });
        return quizSlides;
    }

    // --- LOGIC ---

    function checkLogin() {
        const id = document.getElementById('inputID').value.trim();
        
        if (students[id]) {
            currentUser = students[id];
            currentUser.id = id;
            document.getElementById('userDisplay').innerText = currentUser.name;
            document.getElementById('screen-login').classList.remove('active');
            
            // Prepare Slides
            const randomQuizzes = generateQuizSet();
            currentSessionSlides = [...baseSlides, ...randomQuizzes];
            slideIndex = 0;
            
            renderSlide();
        } else {
            alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡πà‡∏∞ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)");
        }
    }

    function renderSlide() {
        document.getElementById('screen-lesson').innerHTML = ""; 
        document.getElementById('screen-lesson').style.display = "none";
        document.getElementById('screen-result').innerHTML = ""; 
        document.getElementById('screen-result').style.display = "none";

        if (slideIndex >= currentSessionSlides.length) {
            showResult();
            return;
        }

        const s = currentSessionSlides[slideIndex];
        const screen = document.getElementById('screen-lesson');
        screen.style.display = "flex"; 
        screen.classList.add('active');

        if (s.type === 'quiz-intro') quizScore = 0;

        let html = `<h2>${s.title || "Question " + (slideIndex - baseSlides.length + 1)}</h2>`;

        if (['intro', 'read', 'quiz-intro'].includes(s.type)) {
            html += `<div class="content-box">${s.html}</div>`;
            html += renderNav(true);
        }
        else if (s.type === 'exercise') {
            html += `<p class="instruction">${s.desc}</p>`;
            html += `<div id="ex-area" class="content-box"></div>`;
            html += `<button class="btn btn-primary" onclick="checkExercise(${s.id})">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>`;
        }
        else if (s.type === 'game') {
            html += `<p class="instruction">‡πÅ‡∏ï‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (3 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ)</p>`;
            html += `<div class="ans-slot" id="game-slot">‡∏•‡∏≥‡∏î‡∏±‡∏ö: -</div>`;
            html += `<div class="sort-area" id="sort-area"></div>`;
            html += `<div class="btn-nav-group"><button class="btn btn-secondary" onclick="resetGame()">‡∏•‡πâ‡∏≤‡∏á</button><button class="btn btn-primary" onclick="checkGame()">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button></div>`;
        }
        else if (s.type === 'quiz') {
            html += `<div class="quiz-container">
                        <div class="quiz-progress">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${slideIndex - baseSlides.length + 1} / 10</div>
                        <div class="content-box" style="font-weight:bold; font-size:1.2em;">${s.q}</div>
                        <div id="quiz-options"></div>
                     </div>`;
        }

        screen.innerHTML = `<div style="width:100%;">${html}</div>`;

        if (s.type === 'exercise') initExercise(s);
        if (s.type === 'game') initGame(s);
        if (s.type === 'quiz') initQuiz(s);
    }

    function renderNav(showBack) {
        let backBtn = (showBack && slideIndex > 0) ? `<button class="btn btn-secondary" onclick="prevSlide()">‚¨ÖÔ∏è ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>` : `<div></div>`;
        return `<div class="btn-nav-group">${backBtn}<button class="btn btn-primary" style="width:auto;" onclick="nextSlide()">‡πÑ‡∏õ‡∏ï‡πà‡∏≠ ‚û°Ô∏è</button></div>`;
    }

    function nextSlide() { slideIndex++; renderSlide(); }
    function prevSlide() { slideIndex--; renderSlide(); }

    // --- EXERCISE ---
    let exSel = { mi: null, sd: [] };
    function initExercise(s) {
        exSel = { mi: null, sd: [] };
        const area = document.getElementById('ex-area');
        s.sentences.forEach((txt, idx) => {
            let div = document.createElement('div');
            div.className = 'sentence-item';
            div.innerText = txt;
            div.onclick = () => toggleSentence(div, idx, s.id);
            area.appendChild(div);
        });
    }

    function toggleSentence(el, idx, exId) {
        const maxSD = exId === 3 ? 3 : 2; 
        if (exSel.mi === null) {
            exSel.mi = idx; el.classList.add('sel-mi');
            alert(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Main Idea ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞\n‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Supporting Details ‡∏≠‡∏µ‡∏Å ${maxSD} ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏Ñ‡πà‡∏∞`);
        } else if (exSel.mi !== idx) {
            if (idx === exSel.mi) {
                exSel.mi = null; el.classList.remove('sel-mi');
            } else {
                if (exSel.sd.includes(idx)) {
                    exSel.sd = exSel.sd.filter(i => i !== idx); el.classList.remove('sel-sd');
                } else {
                    if (exSel.sd.length < maxSD) {
                        exSel.sd.push(idx); el.classList.add('sel-sd');
                    } else {
                        alert(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å SD ‡∏Ñ‡∏£‡∏ö ${maxSD} ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞`);
                    }
                }
            }
        }
    }

    function checkExercise(exId) {
        const s = currentSessionSlides[slideIndex];
        const reqSD = exId === 3 ? 3 : 2;
        
        if (exSel.mi === null || exSel.sd.length < reqSD) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡πà‡∏∞"); return; }
        
        let miOk = (exSel.mi === s.ansMI);
        let sdOk = exSel.sd.every(v => s.ansSD.includes(v));

        if (miOk && sdOk) { alert("üéâ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å"); nextSlide(); }
        else { alert("‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"); renderSlide(); }
    }

    // --- GAME ---
    let gamePicks = [];
    function initGame(s) {
        gamePicks = [];
        const area = document.getElementById('sort-area');
        s.items.forEach(item => {
            let div = document.createElement('div');
            div.className = 'sort-card';
            div.innerText = item.txt;
            div.onclick = () => pickGameItem(item.id, div);
            area.appendChild(div);
        });
    }
    function pickGameItem(id, el) {
        if (gamePicks.length >= 3 || gamePicks.includes(id)) return;
        gamePicks.push(id); el.classList.add('picked');
        document.getElementById('game-slot').innerText = gamePicks.join(" ‚ûî ");
    }
    function resetGame() { gamePicks = []; renderSlide(); }
    function checkGame() {
        const s = currentSessionSlides[slideIndex];
        if (JSON.stringify(gamePicks) === JSON.stringify(s.answer)) { alert("üéâ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞!"); nextSlide(); }
        else { alert("‚ùå ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ñ‡πà‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞"); resetGame(); }
    }

    // --- QUIZ ---
    function initQuiz(s) {
        const area = document.getElementById('quiz-options');
        s.options.forEach((opt, idx) => {
            let btn = document.createElement('button');
            btn.className = 'quiz-option';
            btn.innerText = opt;
            btn.onclick = () => answerQuiz(btn, idx, s.ans);
            area.appendChild(btn);
        });
    }

    function answerQuiz(btn, selected, correct) {
        const allBtns = document.querySelectorAll('.quiz-option');
        allBtns.forEach(b => b.classList.add('locked')); 

        if (selected === correct) {
            btn.classList.add('correct');
            quizScore++;
            setTimeout(() => nextSlide(), 500); 
        } else {
            btn.classList.add('wrong');
            allBtns[correct].classList.add('correct'); 
            setTimeout(() => nextSlide(), 1500); 
        }
    }

    // --- RESULT ---
    function showResult() {
        document.getElementById('screen-lesson').style.display = "none";
        const resScreen = document.getElementById('screen-result');
        resScreen.style.display = "flex";
        
        const passed = (quizScore === 10);
        const now = new Date();
        const dateStr = now.toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' });
        const timeStr = now.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
        const refCode = "P-" + Math.random().toString(36).substr(2, 6).toUpperCase();

        if (passed) {
            resScreen.innerHTML = `
                <h2 style="color:var(--primary)">Mission Complete!</h2>
                <div class="cert-card">
                    <div class="watermark-container" id="wm-area"></div>
                    <div class="cert-content">
                        <div class="cert-header">Certificate of Excellence</div>
                        <h3 class="cert-title">Paragraph Master</h3>
                        <p>‡∏Ç‡∏≠‡∏°‡∏≠‡∏ö‡∏ß‡∏∏‡∏í‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤</p>
                        <div class="cert-name">${currentUser.name}</div>
                        <p>${currentUser.class} | ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${currentUser.no}</p>
                        <div class="cert-score">10/10</div>
                        <p style="color:green; font-weight:bold;">FULL SCORE</p>
                        <div style="margin-top:20px; font-size:0.8em; color:#777; border-top:1px dashed #ccc; padding-top:10px;">
                            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${dateStr} ‡πÄ‡∏ß‡∏•‡∏≤ ${timeStr}<br>Ref Code: ${refCode}
                        </div>
                    </div>
                </div>
                <p style="margin-top:20px; color:#666; font-size:0.9em;">üì∏ ‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ô‡∏µ‡πâ‡∏™‡πà‡∏á‡∏Ñ‡∏£‡∏π‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞</p>
                <button class="btn btn-secondary" onclick="location.reload()" style="margin-top:15px;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            `;
            
            const wm = document.getElementById('wm-area');
            const txt = `${currentUser.id} ${currentUser.name}`;
            for(let i=0; i<15; i++) {
                let s = document.createElement('div');
                s.className = 'wm-item';
                s.innerText = txt;
                wm.appendChild(s);
            }
        } else {
            resScreen.innerHTML = `
                <div class="mission-fail" style="width:100%;">
                    <div style="font-size:4em;">üò¢</div>
                    <h2 style="color:#c62828;">Mission Failed</h2>
                    <p style="font-size:1.4em; font-weight:bold;">‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ ${quizScore}/10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                    <p>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô: 10/10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
                    <p style="color:#666; font-size:0.9em;">‡∏™‡∏π‡πâ‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡πâ‡∏≤‡∏≤‡∏≤!</p>
                    <button class="btn btn-primary" onclick="restartQuiz()">‚Ü∫ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
                </div>
            `;
        }
    }

    function restartQuiz() {
        quizScore = 0;
        const newQuizzes = generateQuizSet();
        currentSessionSlides = [...baseSlides, ...newQuizzes];
        slideIndex = baseSlides.length - 1; 
        renderSlide();
    }

    // --- ADMIN RESET ---
    function adminReset() {
        const targetSecret = "UGFsb2xpaXo="; // Paloliiz in Base64
        let input = prompt("üîê Admin Reset (‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö):");
        try {
            if (input && btoa(input) === targetSecret) {
                localStorage.clear();
                alert("‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡πà‡∏∞");
                location.reload();
            } else if (input) {
                alert("‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞");
            }
        } catch(e) { alert("‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞"); }
    }

</script>

</body>
</html>
